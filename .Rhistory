freqData
freqData$child <- as.numeric(as.character(freqData$child))
names(freqData) <- c('child','parent','freq')
freqData$child <- as.numeric(as.character(freqData$child))
freqData$child
freqData$parent <- as.numeric(as.character(freqData$parent))
ggplot(filter(freqData,freq>0),aes(x=parent,y=child))+
scale_size(range=c(2,20),guide='none')
ggplot(filter(freqData,freq>0),aes(x=parent,y=child))+
scale_size(range=c(2,20),guide='none')+
geom_point(colour='grey50',aes(size=freq+20,show_guide=FALSE))+
ggplot(filter(freqData,freq>0),aes(x=parent,y=child))+
scale_size(range=c(2,20),guide='none')+
geom_point(colour='grey50',aes(size=freq+20,show_guide=FALSE))
ggplot(filter(freqData,freq>0),aes(x=parent,y=child))+
scale_size(range=c(2,20),guide='none')+
geom_point(colour='grey50',aes(size=freq+20,show_guide=FALSE))+
geom_point(aes(colour=freq,size=freq))
ggplot(filter(freqData,freq>0),aes(x=parent,y=child))+
scale_size(range=c(2,20),guide='none')+
geom_point(colour='grey50',aes(size=freq+20,show_guide=FALSE))+
geom_point(aes(colour=freq,size=freq))+
scale_colour_gradient(low='lightblue',high='white')
beta1 <- cor(y,x)*sd(y)/sd(x)
beta1 <- cor(y,x)*sd(y)/sd(x)
beta1
beta0 <- mean(y) - beta1*mean(x)
beta0
mean(y)
y
rbind(c(beta0,beta1),coef(lm(y~x)))
galton$child
galton
galton$child
mean(galton$child)
y<- galton$child
x <- galton$parent
beta1 <- cor(y,x)*sd(y)/sd(x)
beta0 <- mean(y) - beta1*mean(x)
beta0
yc <- y- mean(y)
xc <- x - mean(x)
beta1 <- sum(yc*xc)/sum(xc^2)
c(beta1,coef(lm(y~x))[2])
ggplot(filter(freqData,freq>0),aes(x=parent,y=child))+
scale_size(range=c(2,20),guide='none')+
geom_point(colour='grey50',aes(size=freq+20,show_guide=FALSE))+
geom_point(aes(colour=freq,size=freq))+
scale_colour_gradient(low='lightblue',high='white')+
geom_smooth(method='lm',formula=y~x)
x <- rnorm(100)
y<- rnomr(100)
y<- rnorm(100)
x
odr <- order(x)
odr
x[odr[100]]
y[odr[100]]
x <- c(0.18,-1.54,0.42,0.95)
w <- c(2,1,3,1)
w
x*w
x*w/4
mean(x*w)
mean(x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
?lm
lm(x~y)
0.8*0.59
lm(y~x)
0.8*1.56
0.47*1.56
lm(y~x-1)
data(mtcars)
lm(matcars$mpg ~ matcars$weight)
lm(mtcars$mpg ~ mtcars$weight)
names(mtcars)
lm(mtcars$mpg ~ mtcars$wt)
coef(lm(mtcars$mpg ~ mtcars$wt))
0.5*2
1.5*0.4
x <- c(8.58, 10.46, 9.01, 9.64, 8.86)
(x-mean(x))/sd(x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(x~y)
lm(y~x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
mean(x)
lm(y~x)
lm(x~y)
-1.7/-0.044
x
y
var(x)/var(y)
var(y)/var(x)
x <- c(0.18, -1.54, 0.42, 0.95)
w <- c(2, 1, 3, 1)
mean(x*w)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(x~y -1)
lm(y~x -1)
lm(mtcars$mpg ~mtcars$wt)
c(0.8263,-5.34,1,0.6,-0.97,1.56,0,0.57)
x <- c(0.18, -1.54, 0.42, 0.95)
w <- c(2, 1, 3, 1)
sum(x*w)/7
mean(x*w)
x*w
lol <- x*w
mean(lol)
library(swirl)
install_from_swirl('Regression Models')
swirl()
plot(child ~ parent,galton)
plot(jitter(child,4)  ~ parent,galton)
regrline <- lm(child ~ parent,galton)
abline(regrlie,lwd=3,col='red')
abline(regrline,lwd=3,col='red')
summary(regrline)
fit <- lm(child ~ parent,galton)
summarY(fit)
summary(fit)
mean(fit$residuals)
cov(fit$residuals,galton$parents)
cov(fit$residuals,galton$parent)
library(Swirl)
library(swirl)
swirl()
ols.ic <- fit$coef[1]
ols.slope <- fit$coef[2]
?sqe
rhs/lhs
lhs-rhs
all.equal(lhs,rhs)
varChild <- var(children)
varChild <- var(childrens)
2
varChild <- var(galton$child)
varRes <- var(fit$residuals)
varRes
fit$residuals
varEst <- var(est(ols.slope,ols.ic))
all.equal(varChild,sum(varRes,varEst))
all.equal(varChild,varRes+varEst)
efit <- lm(accel ~ mag+dist, attenu)
mean(efit$residuals)
cov(efit$residuals,attenu$mag)
cov(efit$residuals,attenu$dist)
cor(gpa_nor,gch_nor)
l_nor <- lm(child~par,data)
2
l_nor <- lm(gch_nor~gpa_nor)
quit()
rm(list=ls())
data(mtcars)
str(mtcars)
sapply(mtcars,unique)
summary(mtcars)
mtcars$cyl <- factor(mtcars$cyl)
mtcars$vs <- factor(mtcars$vs)
mtcars$am <- factor(mtcars$am)
mtcars$gear <- factor(mtcars$gear)
mtcars$carb <- factor(mtcars$carb)
boxplot(mpg~am,data=mtcars)
library(ggplot2)
ggplot(mtcars,aes(mpg,am))+
geom_boxplot()
ggplot(mtcars,aes(am,mpg))+
geom_boxplot()
ggplot(mtcars,aes(am,mpg))+
geom_boxplot()+
geom_jitter()
mtcars$am <- factor(mtcars$am,labels=c('Automatic','Manual'))
ggplot(mtcars,aes(am,mpg))+
geom_boxplot()+
geom_jitter()
FirstModel <- lm(mpg~.,data=mtcars)
plot()
plot(FirstModel)
rm(list=ls())
data(mtcars)
mtcars$cyl <- factor(mtcars$cyl)
mtcars$vs <- factor(mtcars$vs)
mtcars$am <- factor(mtcars$am,labels=c('Automatic','Manual'))
mtcars$gear <- factor(mtcars$gear)
mtcars$carb <- factor(mtcars$carb)
FirstModel <- lm(mpg~.,data=mtcars)
summary(FirstModel)
SecondModel <- lm(mpg~cyl+hp+wt+am,data=mtcars)
ThirdModel <- lm(mpg~am,data=mtcars)
anova(FirstModel,SecondModel,ThirdModel)
anova(FirstModel,SecondModel)
anova(SecondModel,ThirdModel)
?anova
anova(FirstModel,SecondModel,ThirdModel)
?t.test
data(mtcars)
cor(mtcars)
cor(mtcars)[1:11]
cor(mtcars)[1:11,1:1]
FirstModel <- lm(mpg~.,data=mtcars)
step(FirstModel,direction='both')
summary(step(FirstModel,direction='both'))
model <- lm(mpg~as.factor(cyl)+weight,data=mtcars)
model <- lm(mpg~as.factor(cyl)+wt,data=mtcars)
summary(model)
str(mtcars)
model <- lm(mpg~as.factor(cyl),data=mtcars)
summary(model)
model <- lm(mpg~as.factor(cy)+wt,data=mtcars)
model <- lm(mpg~as.factor(cyl)+wt,data=mtcars)
model2 <- lm(mpg~as.factor(cyl)*wt,data=mtcars)
anova(model,model2)
lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
lm(mpg ~ wt + factor(cyl), data = mtcars)
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
lm(y~x)
x<- lm(y~x)
hatvalues(x)
dfbetasI(x)
dfbetas(x)
?aov
init_fit <- lm(mpg ~ ., data = mtcars)
best_fit <- step(init_fit, direction = "both")
summary(best_fit)
?shuttle
library(MASS)
?shuttle
rm(list-ls())
rm(list=ls())
data(shuttle)
str(shuttle)
shuttle$use
as.numeric(shuttle$use)
?As.numeric
?as.numeric
as.numeric(shuttle$use)
as.numeric(shuttle$use=='auto')
shuttle$use <- as.numeric(shuttle$use=='auto')
?glm
str(shuttle)
fit <- glm(use~wind,data=shuttle)
summary(fit)
str(shuttle)
predict(fit,'head')
predict(fit,as.factor('head'))
predict(fit,wind=as.factor('head'))
fit <- glm(use~wind-1,data=shuttle,family='binomial')
summary(fit)
summary(fit)%coef
summary(fit)$coef
summary(fit)$coef[1]
summary(fit)$coef[2]
summary(fit)$coef[1]
exp(summary(fit)$coef[1])
exp(summary(fit)$coef[2])
summary(fit)$coef[1]/summary(fit)$coef[2]
str(shuttle)
fit2 <- glm(use~magn-1,data=shuttle,family='binomial')
summary(fit2)$coef
summary(fit2)$coef[1]
fit2 <- glm(use~wind+magn-1,data=shuttle,family='binomial')
summary(fit2)$coef
summary(fit2)
coef(fit2)
exp(coef(fit))
exp(coef(fit2))
conflint(fit2)
confint(fit2)
rm(list=ls())
data(InsectSprays)
str(InsectSprays)
fit <- glm(count~spray-1,data=InsectSprays,family='Poisson')
fit <- glm(count~spray-1,data=InsectSprays,family='poisson')
summary(fit)$coef
coef(fit)
exp(coef(fit))
exp(coef(fit))[1]
exp(coef(fit))[1]/exp(coef(fit))[2]
x <- -5:5
y <- c(5.12, 3.93, 2.67, 1.87, 0.52, 0.08, 0.93, 2.05, 2.54, 3.87, 4.97)
library(swirl)
swirl()
fit <- lm(child~parent,data=galton)
sqrt(sum(fit$residuals)/(n-2))
sqrt(sum(fit$residuals^2)/(n-2))
summary(fit)%sigma
summary(fit)$sigma
sqrt(deviance(fit)/(n-2))
mu <- mean(galton$child)
sTot <- sum(galton$child^2)
sTot <- sum((galton$child-mu)^2)
sRes <- deviance(galton$child)
1
sRes <- deviance(fit)
1-sRes/sTot
summary(fit)$r.squaredd
summary(fit)$r.squared
cor(childre~parents,data=galton)
cor(galton$children~galton$parents)
1
cor(galton$parent,galton$child)^2
ones <- rep(1,nrow(galton))
lm(child ~ ones +parent -1,galton)
lm(child ~ ones +parent,galton)
lm(child~`,galton)
lm(child~1,galton)
view(trees)
head(trees)
fit <- lm(Volume ~ Girth + Height + COnstant -1,trees)
fit <- lm(Volume ~ Girth + Height + cOnstant -1,trees)
fit <- lm(Volume ~ Girth + Height + Constant -1,trees)
trees2 <- eliminate('Girth',trees)
head(trees2)
fit2 <- lm(Volume ~ Height + Constant -1, trees2)
lapply(list(fit1,fit2),coef)
lapply(list(fit,fit2),coef)
lm(Fertility~.,data=swiss)
lm(Fertility~.,swiss)
all <- lm(Fertility~.,swiss)
summmary(all)
summary(all)
lm(Fertility~agriculture,swiss)
lm(Fertility~Agriculture,swiss)
SUMMARY(lm(Fertility~Agriculture,swiss))
summary(lm(Fertility~Agriculture,swiss))
cor(swiss$Examination,swiss$Education)
cor(swiss$Agriculture,swiss$Education)
makelms()
ec <- swiss$Examination + swiss$Catholic
efit <- (Fertility~. + ec,swiss)
efit <- (Fertility~ . + ec,swiss)
1
efit <- lm(Fertility ~ . + ec, swiss)
summary(efit)$coef
all$coefficients-efit$coefficients
6
dim(InsectSprays)
head(InsectSprays)
head(InsectSprays,15)
A
1
sB
summary(InsectSpray)
summary(InsectSprays)
summary(InsectSprays[,2])
sapply(InsectSprays,ncol)
sapply(InsectSprays,class)
fit <- lm(count~spray,InsectSprays)
summary(fit)
summary(fit)$coef
est <- summary(fit)$coef[,1]
mean(sA)
mean(sB)
fit <- lm(count~spray-1,InsectSprays)
nfit <- lm(count~spray-1,InsectSprays)
summary(Nfit)$coef
summary(nfit)$coef
1
spray2 <- relevel(InsectSprays$spray,\"C\")
spray2 <- relevel(InsectSprays$spray,"C")
fit2 <- lm(count~spray2-1,InsectSprays)
fit2 <- lm(count~spray2,InsectSprays)
summary(fit2)$coef
mean(cS)
mean(sC)
1
(fit$coef[2]-fit$coef[3])/1.6011
dim(hunger)
948
names(hunger)
fit <- lm(hunger~Year,hunger)
fit <- lm(Numeric~Year,hunger)
summary(Fit)$coef
summary(fit)$coef
1
lmF <- lm(hunger$Numeric[hunger$Sex=="Female"] ~ hunger$Year[hunger$Sex=="Female"])
lmM <- lm(hunger$Numeric[hunger$Sex=="Male"] ~ hunger$Year[hunger$Sex=="Male"])
lmBoth <- lm(Numeric~ Year + sex,hunger)
lmBoth <- lm(Numeric~ Year + Sex,hunger)
summary(lmBoth)
lmInter <- lm(Numeric~ Year + Sex + Sex*Year)
lmInter <- lm(Numeric~ Year + Sex + Sex*Year,hunger
)
summary(lmInter)
rm(list=ls())
library(swirl)
swirl()
fit <- lm(y~x,out2)
plot(fit,which=1)
fitno <- lm(y~x,out2[-1,])
plot(fitno,which=1)
coef(fitno)-coef(fit)
coef(fit)-coef(fitno)
head(dfbeta(fit))
resno <- out2[1,'y'] - predict(fitno,out2[1,])
1-resid(fit)[1]/resno
head(hatvalues(fit))
1
sigma <- sqrt(deviance(fit)/df.residual(fit))
1
rstd <- resid(fit)/(sigma * sqrt(1-hatvalues(fit)))
head(cbind(rstd,rstandard(fit)))
plot(fit,which=3)
plot(fit,which=2)
1
sigma1 <- sqrt(deviance(fitno)/df.residual(fitno))
1
resid(fit)[1]/(sigma1*sqrt(1-hatvalues(fit)[1]))
head(rstudent(fit))
dy <- predict(fit,out2) - predict(fitno,out2)
dy-2*sigma^2
sum(dy^2)/(2*sigma^2)
cooks.distance(fit)[1]
plot(fit,which=5)
rgp1()
rgp2()
head(Swiss)
head(swiss)
mdl <- lm(Fertility~.,swiss)
vif(mdl)
mdl <- lm(Fertility ~ . - Examination,swiss)
mdl2 <- lm(Fertility ~ . - Examination,swiss)
vif(mdl2)
1
x1c <- simbias()
apply(x1c,1,mean)
fit1 <- lm(Fertility~ Agriculture,swiss)
fit3 <- lm(Fertility~ Agriculture + Examination + Education)
fit3 <- lm(Fertility~ Agriculture + Examination + Education,swiss)
anova(fit1,fit3)
deviance(fit3)
d <- deviance(fit3)/43
1
n <- (deviance(fit1) - deviance(fit3))/2
n/d
1
pf(n/d, 2, 43, lower.tail=FALSE)
shapiro.test(fit3$residuals)
anova(fit1,fit3,fit5,fit6)
ravenData
mdl <- glm(ravenWinNum ~ ravenScore,ravenData)
mdl <- glm(ravenWinNum ~ ravenScore,ravenData,family='binomial')
lodds <- data.frame(ravenScore=c(0,3,6))
lodds <- predict(mdl, data.frame(ravenScore=c(0, 3, 6)))
exp(lodds)/(1+exp(lodds))
summary(mdl)
conflint(mdl)
confint(mdl)
exp(confint(mdl))
anova(mdl)
qchisq(0.95,1)
var(rpois(1000,50))
nxt()
head(hits)
class(hits[,'date'])
as.integer(head(hits[,'date']))
mdl <- glm(visits~date,poission,hits)
mdl <- glm(visits~date,poisson,hits)
summary(mdl)
confint(mdl,'date')
exp(confint(mdl,'date'))
which.max(hits[,'visits'])
hits[704,]
lambda <- mdl$fitted.values[704]
qpois(.95,lambda)
q1
1
mdl2 <- glm(formula = simplystats ~ date, family = poisson, data = hits, offset = log(visits + 1))
qpois(.95,mdl2$fitted.values[70p4])
qpois(.95,mdl2$fitted.values[704])
quit()
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/Coursera/DevelopingDataProducts')
runApp('App')
library(shiny)
runApp('App')
runApp('App')
Data <- read.csv('data.csv')
View(Data)
View(Data)
head(Data)
Date <- summaryBy(Age~Date,data=Data,FUN=c(length))
Date$Date<-as.Date(Date$Date,'%Y-%m-%d')
Year2015N <- Date[year(Date$Date)==2015,]
Year2015N$Week <- week(Year2015N$Date)
Year2014N <- Date[year(Date$Date)==2014,]
Year2014N$Week <- week(Year2014N$Date)
Year2013N <- Date[year(Date$Date)==2013,]
Year2013N$Week <- week(Year2013N$Date)
head(Year2014N)
tail(Year2014N)
Weekly2014 <- summaryBy(Age.length~Week,data=Year2014N,FUN=sum,na.rm=TRUE)
head(Weekly2014)
tail(Weekly2014)
dim(Data)
Data[1300,]
Data[1600,]
Data[1800,]
Data[1700,]
Data[1750,]
Data[1720,]
Data[1710,]
Data[1711,]
Data[1715,]
Data[1717,]
Data[1716,]
Data[1715,]
runApp('App')
